# Exchange Related Group Membership
```
An unmodified Microsoft Exchange installation in an AD environment exposes multiple attack vectors, as it is granted significant privileges. 
The "Exchange Windows Permissions" group can be exploited to grant DCSync privileges to a user. 
Also, the "Organization Management" group in Exchange has considerable power, acting like "Domain Admins" and accessing all domain user mailboxes.
```
# PrivExchange
```
The PrivExchange attack exploits a flaw in the Exchange Server PushSubscription feature, allowing any domain user with a mailbox 
to force the Exchange server to authenticate to any HTTP host. 
This over-privileged service can be abused to dump the domain NTDS database or gain access to other hosts within the domain, 
potentially leading to Domain Admin privileges with any authenticated domain user account.
```
# Printer Bug
```
The Printer Bug is a vulnerability in the MS-RPRN protocol, allowing any domain user to exploit it and gain access to a print server over SMB. 
It can be used to retrieve password hashes from AD and grant unauthorized privileges. 
The bug can also compromise a Domain Controller in a partner domain if specific conditions are met. 
Tools like Get-SpoolStatus can help identify vulnerable machines.
```
## Enumerating for MS-PRN Printer Bug
```powershell
Import-Module .\SecurityAssessment.ps1
Get-SpoolStatus -ComputerName PC'SNAME.MYDOMAIN.LOCAL
```
# MS14-068
```
(MAntis machine in htb https://app.hackthebox.com/machines/98)
The flaw in the Kerberos protocol allowed attackers to exploit standard domain user credentials to elevate privileges to Domain Admin.
Normally, a Kerberos ticket contains user information, including account details and group membership in the Privilege Attribute Certificate (PAC),
signed by the KDC for validation.
However, the vulnerability allowed a forged PAC to be accepted as legitimate, enabling the creation of a fake PAC to present a user as a
member of Domain Administrators or other privileged groups.
Exploitation can be done using tools like Python Kerberos Exploitation Kit (PyKEK) or the Impacket toolkit.
```
# Sniffing LDAP Credentials
```
Attackers can exploit weak or default passwords in web admin consoles of applications and printers to access stored LDAP credentials.
Sometimes, these credentials are even stored in cleartext.
The attacker can change the LDAP IP address to their own attack host and set up a netcat listener on LDAP port 389 to capture the credentials
when the application attempts to test the LDAP connection.
These credentials are often privileged, providing a foothold in the domain. In some cases, a full LDAP server may be needed for this attack.
```




