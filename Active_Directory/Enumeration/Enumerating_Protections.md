# Enumerating Protections

##  AppLocker
https://learn.microsoft.com/en-us/windows/security/application-security/application-control/windows-defender-application-control/applocker/applocker-overview
```cmd
Get-AppLockerPolicy -Local
```

## Windows Defender
```powershell
Get-MpComputerStatus
```
## List AppLocker Rules
```powershell
Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections
```
### Test AppLocker Policy
```powershell
Get-AppLockerPolicy -Local | Test-AppLockerPolicy -path C:\Windows\System32\cmd.exe -User Everyone
```


# Checking Defenses
## Firewall Checks
```powershell
netsh advfirewall show allprofiles
``` 
## Windows Defender Check 
```powershell
sc query windefend
#cmd
#check status with powershell:
Get-MpComputerStatus
# give information about AMProductVersion
```
